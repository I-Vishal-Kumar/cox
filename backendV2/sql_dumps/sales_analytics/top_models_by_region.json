{
  "query_name": "top_models_by_region",
  "category": "sales_analytics",
  "description": "Top selling vehicle models by region (last 7 days)",
  "keywords": [
    "top",
    "selling",
    "models",
    "region",
    "northeast",
    "midwest",
    "west",
    "southeast"
  ],
  "sql_query": "\n            SELECT \n                d.region,\n                f.vehicle_type as model_name,\n                COUNT(*) as transaction_count,\n                SUM(f.sale_price) as total_revenue,\n                AVG(f.sale_price) as avg_transaction_value\n            FROM fni_transactions f\n            JOIN dealers d ON f.dealer_id = d.id\n            WHERE f.transaction_date >= date('now', '-7 days')\n            GROUP BY d.region, f.vehicle_type\n            ORDER BY d.region, total_revenue DESC\n            LIMIT 50\n            ",
  "data": [
    {
      "region": "Midwest",
      "model_name": "New",
      "transaction_count": 156,
      "total_revenue": 6384514.72,
      "avg_transaction_value": 40926.37641025641
    },
    {
      "region": "Midwest",
      "model_name": "Used",
      "transaction_count": 119,
      "total_revenue": 4896415.64,
      "avg_transaction_value": 41146.349915966384
    },
    {
      "region": "Northeast",
      "model_name": "Used",
      "transaction_count": 92,
      "total_revenue": 3708699.05,
      "avg_transaction_value": 40311.94619565217
    },
    {
      "region": "Northeast",
      "model_name": "New",
      "transaction_count": 86,
      "total_revenue": 3451180.09,
      "avg_transaction_value": 40130.00104651163
    },
    {
      "region": "Southeast",
      "model_name": "New",
      "transaction_count": 59,
      "total_revenue": 2456545.06,
      "avg_transaction_value": 41636.35694915254
    },
    {
      "region": "Southeast",
      "model_name": "Used",
      "transaction_count": 59,
      "total_revenue": 2331311.26,
      "avg_transaction_value": 39513.75016949152
    },
    {
      "region": "West",
      "model_name": "Used",
      "transaction_count": 64,
      "total_revenue": 2681880.46,
      "avg_transaction_value": 41904.3821875
    },
    {
      "region": "West",
      "model_name": "New",
      "transaction_count": 56,
      "total_revenue": 2392240.04,
      "avg_transaction_value": 42718.57214285714
    }
  ],
  "metadata": {
    "generated_at": "2025-12-12T13:03:18.782031",
    "row_count": 8,
    "data_size_kb": 1.1142578125
  },
  "chart_config": {
    "type": "bar",
    "title": "Top Models By Region",
    "responsive": true,
    "data": {
      "labels": [
        "Midwest",
        "Midwest",
        "Northeast",
        "Northeast",
        "Southeast",
        "Southeast",
        "West",
        "West"
      ],
      "datasets": [
        {
          "label": "Revenue",
          "data": [
            6384514.72,
            4896415.64,
            3708699.05,
            3451180.09,
            2456545.06,
            2331311.26,
            2681880.46,
            2392240.04
          ],
          "backgroundColor": "rgba(54, 162, 235, 0.6)"
        }
      ]
    },
    "options": {
      "plugins": {
        "title": {
          "display": true,
          "text": "Top Models By Region"
        }
      }
    }
  }
}